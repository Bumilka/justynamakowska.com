
app_shop.vars.rebateCode={init:function(){setTimeout(function(){$('.affiliate_promo_codes_kolorystyka').append($('#iColorPicker'));},500);$('a#show_generator_form').on('click',function(){$('form#affiliate_form_promo_codes').slideDown();});$('select#promo_codes_shop').on('change',function(){var shop=$('select#promo_codes_shop').val();$('select#promo_codes_code > option').hide();$('select#promo_codes_code > option[data-shop*="'+shop+'"]').show();$('select#promo_codes_code').val($('select#promo_codes_code > option:visible').first().text());});$('select#promo_codes_shop, select#promo_codes_code').on('change',function(){var currShop=$('select#promo_codes_shop').val();var currCode=$('select#promo_codes_code').val();app_shop.vars.rebateCode.toggleCode(currShop,currCode);$('#promo_code_text').attr('placeholder',$('#promo_code_text').data('initval').replace('%s',currCode));}).change();$('input[name="promo_code_radio"]').on('change',function(){var linkType=$('input[name="promo_code_radio"]:checked').val();var text=$('input#promo_code_text').val()||undefined;var textSize=parseFloat($('input#promo_code_text_size').val());var textColor=$('#color3').css('background-color');var iconColor=$('#color4').css('background-color');var bgColor=$('#color5').css('background-color');var icon=$('.affiliate_promo_icon.selected').find('i').attr('class');app_shop.vars.rebateCode.generatePreview(linkType,text,textSize,textColor,iconColor,bgColor,icon);});$('.affiliate_promo_codes_kolorystyka input').on('input',function(){var linkType=$('input[name="promo_code_radio"]:checked').val();var text=$('input#promo_code_text').val()||undefined;var textSize=parseFloat($('input#promo_code_text_size').val());var textColor=$('#color3').css('background-color');var iconColor=$('#color4').css('background-color');var bgColor=$('#color5').css('background-color');var icon=$('.affiliate_promo_icon.selected').find('i').attr('class');app_shop.vars.rebateCode.generatePreview(linkType,text,textSize,textColor,iconColor,bgColor,icon);});$('#affiliate_form_promo_codes').find('#iColorPicker').find('td').live('click',function(){var linkType=$('input[name="promo_code_radio"]:checked').val();var text=$('input#promo_code_text').val()||undefined;var textSize=parseFloat($('input#promo_code_text_size').val());var textColor=$('#color3').css('background-color');var iconColor=$('#color4').css('background-color');var bgColor=$('#color5').css('background-color');var icon=$('.affiliate_promo_icon.selected').find('i').attr('class');app_shop.vars.rebateCode.generatePreview(linkType,text,textSize,textColor,iconColor,bgColor,icon);});$('.affiliate_promo_icon').on('click',function(){if(!$(this).is('.selected')){$('.affiliate_promo_icon').removeClass('selected');$(this).addClass('selected');}
var linkType=$('input[name="promo_code_radio"]:checked').val();var text=$('input#promo_code_text').val()||undefined;var textSize=parseFloat($('input#promo_code_text_size').val());var textColor=$('#color3').css('background-color');var iconColor=$('#color4').css('background-color');var bgColor=$('#color5').css('background-color');var icon=$('.affiliate_promo_icon.selected').find('i').attr('class');app_shop.vars.rebateCode.generatePreview(linkType,text,textSize,textColor,iconColor,bgColor,icon);});$('#button_generate_code').on('click',function(){var linkType=$('input[name="promo_code_radio"]:checked').val();var text=$('input#promo_code_text').val()||undefined;var textSize=parseFloat($('input#promo_code_text_size').val());var textColor=$('#color3').css('background-color');var iconColor=$('#color4').css('background-color');var bgColor=$('#color5').css('background-color');var icon=$('.affiliate_promo_icon.selected').find('i').attr('class');var preview=app_shop.vars.rebateCode.generatePreview(linkType,text,textSize,textColor,iconColor,bgColor,icon);app_shop.vars.rebateCode.generateCode(preview);return false;});$('#button_generate_link').on('click',function(){app_shop.vars.rebateCode.generateLink();return false;});$('input.affiliate_promo_codes_bold').on('change',function(){var linkType=$('input[name="promo_code_radio"]:checked').val();var text=$('input#promo_code_text').val()||undefined;var textSize=parseFloat($('input#promo_code_text_size').val());var textColor=$('#color3').css('background-color');var iconColor=$('#color4').css('background-color');var bgColor=$('#color5').css('background-color');var icon=$('.affiliate_promo_icon.selected').find('i').attr('class');var preview=app_shop.vars.rebateCode.generatePreview(linkType,text,textSize,textColor,iconColor,bgColor,icon);});$('a.show_rebate_details').on('click',function(){$('body').dialog({content:$(this).parent().parent().siblings('.promo_code_details').html(),wrapperClass:'codeDetailsDialog',fixed:false,width:500});return false;});$('#promo_codes_preview a').live('click',function(){return false;});},toggleCode:function(shop,code){$('.active-code.n67313_out').hide();var currShop=$('.active-code.n67313_out[data-shops*="'+shop+'"]');var currCode=$(currShop).find('.code-name strong:contains('+code+')');if($(currCode).parents('.n67313_out').length){$(currCode).parents('.n67313_out').show();$('.affiliate_form_step').slideDown();}else{$('.active-code.n67313_out.error').show();$('.affiliate_form_step.step2,.affiliate_form_step.step3,.affiliate_form_step.step4').slideUp();}},generatePreview:function(style,text,size,textColor,iconColor,bgColor,icon){var link_begin,link_end,elemStyle,fontWeight;var def={style:'text',text:promoCodes_txt['default_text'],size:promoCodes_txt['default_text_size'],textColor:'#000 !important',iconColor:'#000 !important',bgColor:'#0090f6',icon:'icon-tags'};style=style||def.style;text=text||def.text;size=size||def.size;textColor=textColor||def.textColor;iconColor=iconColor||def.iconColor;bgColor=bgColor||def.bgColor;icon=icon||def.icon;fontWeight=$('input.affiliate_promo_codes_bold').is(':checked')?'bold':'normal';text=text.replace('%s',$('#promo_codes_code').val());switch(style){case'text':link_begin='<a href="#" style="font-size: '+size+'px; color: '+textColor+'; font-weight: '+fontWeight+';">';link_end='</a>';break;case'text_icon':link_begin='<a href="#" style="font-size: '+size+'px; color: '+textColor+'; font-weight: '+fontWeight+';"><i class="'+icon+'" style="margin-right:15px; color: '+iconColor+'; vertical-align:middle; font-size:1.1em;"></i>';link_end='</a>';break;case'button':link_begin='<a href="#" style="font-size: '+size+'px; color: '+textColor+'; background: '+bgColor+'; border:1px solid '+bgColor+'; curor:pointer; display:inline-block; overflow:visible; padding:5px 10px; text-align:center; text-decoration:none; font-weight: '+fontWeight+';">';link_end='</a>';break;case'button_icon':link_begin='<a href="#" style="font-size: '+size+'px; color: '+textColor+'; background: '+bgColor+'; border:1px solid '+bgColor+'; curor:pointer; display:inline-block; overflow:visible; padding:5px 10px; text-align:center; text-decoration:none; font-weight: '+fontWeight+';"><i class="'+icon+'" style="margin-right:15px; color: '+iconColor+'; vertical-align:middle; font-size:1.1em;"></i>';link_end='</a>';break;}
$('div#promo_codes_preview').html(link_begin+text+link_end);return(link_begin+text+link_end);},generateCode:function(linkPreview){var shopUrl='http://'+$('select#promo_codes_shop').val()+'/settings.php?from=client_rebate&global_rebates_codes=add&rebate_codes='+$('select#promo_codes_code').val();var generatedCode=linkPreview.replace('href="#"','href="'+shopUrl+'"');$('textarea#promo_codes_output').text(generatedCode);},generateLink:function(allShops){if(!allShops){var shopUrl='http://'+$('select#promo_codes_shop').val()+'/settings.php?from=client_rebate&global_rebates_codes=add&rebate_codes='+$('select#promo_codes_code').val();$('textarea#promo_codes_output').text(shopUrl);}else{}}};app_shop.run(function(){app_shop.vars.rebateCode.init();},'all','#affiliate_promo_code');